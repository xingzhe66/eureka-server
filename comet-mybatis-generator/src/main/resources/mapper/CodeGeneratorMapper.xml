<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dcits.comet.mybatis.generator.mapper.CodeGeneratorMapper">
    <!--根据表名称获取表描述-->
	<select id="getTableComment" parameterType="java.util.Map" resultType="String">
		<if test="dbType == 'mysql'">
			select TABLE_COMMENT from information_schema.TABLES t
			where t.TABLE_SCHEMA=#{dbName} and TABLE_NAME = #{tableName}
		</if>
		<if test="dbType == 'oracle'">
			select t.comments TABLE_COMMENT from user_tab_comments t
			where t.TABLE_NAME = #{tableName}
		</if>
	</select>
	<!-- 根据数据库名称获取所有表名称及描述 -->
	<select id="getTablesList" parameterType="java.util.Map"  resultType="java.util.Map">
		<if test="dbType == 'mysql'">
			select TABLE_NAME ,TABLE_COMMENT
			from information_schema.TABLES t
			where t.TABLE_SCHEMA=#{dbName}
		</if>
		<if test="dbType == 'oracle'">
			select t.TABLE_NAME,t.comments TABLE_COMMENT from user_tab_comments t
		</if>
		<if test="dbName == 'mssql'">
			select name  as TABLENAME from sysobjects where xtype='u'
		</if>

	</select>


	<!-- 获取列数据 -->
	<select id="getListMap" parameterType="java.util.Map"  resultType="java.util.Map">
		<if test="dbType == 'mysql'">
			SELECT COLUMN_NAME COLUMNNAME,COLUMN_TYPE COLUMNTYPE,COLUMN_KEY COLUMNKEY ,CHARACTER_MAXIMUM_LENGTH DATALENGTH,
			IS_NULLABLE ISNULLABLE,COLUMN_COMMENT COLUMNCOMMENT
			FROM INFORMATION_SCHEMA.COLUMNS T
			WHERE TABLE_NAME = #{tableName} AND T.TABLE_SCHEMA=#{dbName}
		</if>

		<if test="dbType == 'oracle'">
			select t.column_name COLUMNNAME,t.data_type COLUMNTYPE, a.COMMENTS  COLUMNCOMMENT from user_tab_columns t
			INNER JOIN USER_COL_COMMENTS a
			ON t.table_name = a.table_NAME
			AND t.COLUMN_NAME = a.COLUMN_NAME
		</if>

		<if test="dbName == 'mssql'">
			SELECT COLUMN_NAME COLUMNNAME,DATA_TYPE COLUMNTYPE,CHARACTER_MAXIMUM_LENGTH DATALENGTH,
			IS_NULLABLE ISNULLABLE,'' COLUMNCOMMENT FROM INFORMATION_SCHEMA.columns WHERE TABLE_NAME=#{tableName}
		</if>
	</select>

</mapper>